{"code":"export default class Component {\r\n    constructor() {\r\n        this.id = Symbol();\r\n    }\r\n    fmap(fn) {\r\n        return new Value(fn(this.value));\r\n    }\r\n    mutation(fn) {\r\n        const nextValue = fn(this.value);\r\n        if (typeof nextValue !== 'undefined') {\r\n            this.value = nextValue;\r\n        }\r\n        return this;\r\n    }\r\n    chain(fn) {\r\n        return this.fmap(fn).join();\r\n    }\r\n    join() {\r\n        return this.value;\r\n    }\r\n    concat(...components) {\r\n        if (components.some(component => component instanceof None)) {\r\n            return new None();\r\n        }\r\n        return new Values(Array.of(this)\r\n            .concat(components)\r\n            .map(component => component.join()));\r\n    }\r\n}\r\nexport class None {\r\n    constructor() {\r\n        this.id = Symbol();\r\n    }\r\n    fmap() {\r\n        return new None();\r\n    }\r\n    mutation() {\r\n        return this;\r\n    }\r\n    join() {\r\n        return undefined;\r\n    }\r\n    chain() {\r\n        return this.join();\r\n    }\r\n    concat() {\r\n        return this;\r\n    }\r\n}\r\nexport class Value extends Component {\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n}\r\nclass Values extends Value {\r\n    concat(...components) {\r\n        if (components.some(component => component instanceof None)) {\r\n            return new None();\r\n        }\r\n        return new Values(this.join().concat(components));\r\n    }\r\n}\r\nexport class Binder extends Component {\r\n    constructor(ctx, propName) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.propName = propName;\r\n    }\r\n    get value() {\r\n        if (this.getterHook) {\r\n            this.getterHook(this.ctx[this.propName]);\r\n        }\r\n        return this.ctx[this.propName];\r\n    }\r\n    set value(value) {\r\n        this.ctx[this.propName] = value;\r\n        if (this.setterHook) {\r\n            this.setterHook(value);\r\n        }\r\n    }\r\n}\r\nexport class Mutator extends Component {\r\n    constructor(value, hook) {\r\n        super();\r\n        this.hook = hook;\r\n        this._value = value;\r\n        this.value = value;\r\n    }\r\n    get value() {\r\n        return this._value;\r\n    }\r\n    set value(value) {\r\n        this._value = value;\r\n        if (this.hook) {\r\n            this.hook(this._value);\r\n        }\r\n    }\r\n}\r\n// interface Sprite {\r\n//   x: number,\r\n//   y: number\r\n// }\r\n// class Position extends Value<Sprite> {\r\n//   constructor(value: Sprite, x: number, y: number) {\r\n//     super(value)\r\n//     this.value.x = x\r\n//     this.value.y = y\r\n//   }\r\n// }\r\n// let b = new Position({ x: 1, y: 2 }, 10, 20)\r\n// let a: Component<string> | None = b instanceof Position ? b : new None()\r\n// function getComponent<T>(type: { new (...args: any): T }): T | None {\r\n//   return b instanceof type ? b : new None()\r\n// }\r\n// let foo = getComponent(Position)\r\n//   .mutation(sprite => {\r\n//     sprite.x = 10,\r\n//     sprite.y = 20\r\n//   })\r\n//# sourceMappingURL=component.js.map","references":[],"map":"{\"version\":3,\"file\":\"component.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../src/component/component.ts\"],\"names\":[],\"mappings\":\"AAIA,MAAM,CAAC,OAAO,OAAgB,SAAS;IAMrC;QACE,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE,CAAA;IACpB,CAAC;IAED,IAAI,CAAI,EAAmB;QACzB,OAAO,IAAI,KAAK,CAAI,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAA;IACrC,CAAC;IAED,QAAQ,CAAC,EAA0B;QACjC,MAAM,SAAS,GAAG,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;QAChC,IAAI,OAAO,SAAS,KAAK,WAAW,EAAE;YACpC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAA;SACvB;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAED,KAAK,CAAI,EAAmB;QAC1B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAA;IAC7B,CAAC;IAED,IAAI;QACF,OAAO,IAAI,CAAC,KAAK,CAAA;IACnB,CAAC;IAED,MAAM,CAAC,GAAG,UAA2B;QACnC,IAAI,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,YAAY,IAAI,CAAC,EAAE;YAC3D,OAAO,IAAI,IAAI,EAAE,CAAA;SAClB;QACD,OAAO,IAAI,MAAM,CACf,KAAK,CAAC,EAAE,CAAY,IAAI,CAAC;aACtB,MAAM,CAAC,UAAyB,CAAC;aACjC,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CACtC,CAAA;IACH,CAAC;CACF;AAED,MAAM,OAAO,IAAI;IAAjB;QACE,OAAE,GAAG,MAAM,EAAE,CAAA;IAqBf,CAAC;IAnBC,IAAI;QACF,OAAO,IAAI,IAAI,EAAE,CAAA;IACnB,CAAC;IAED,QAAQ;QACN,OAAO,IAAI,CAAA;IACb,CAAC;IAED,IAAI;QACF,OAAO,SAAS,CAAA;IAClB,CAAC;IAED,KAAK;QACH,OAAO,IAAI,CAAC,IAAI,EAAE,CAAA;IACpB,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA;IACb,CAAC;CACF;AAED,MAAM,OAAO,KAAS,SAAQ,SAAY;IAIxC,YAAY,KAAQ;QAClB,KAAK,EAAE,CAAA;QACP,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IACpB,CAAC;CACF;AAED,MAAM,MAAO,SAAQ,KAAY;IAC/B,MAAM,CAAC,GAAG,UAAuB;QAC/B,IAAI,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,YAAY,IAAI,CAAC,EAAE;YAC3D,OAAO,IAAI,IAAI,EAAE,CAAA;SAClB;QACD,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAA;IACnD,CAAC;CACF;AAED,MAAM,OAAO,MAAU,SAAQ,SAAqB;IAMlD,YAAY,GAAM,EAAE,QAAiB;QACnC,KAAK,EAAE,CAAA;QACP,IAAI,CAAC,GAAG,GAAG,GAAG,CAAA;QACd,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAA;IAC1B,CAAC;IAED,IAAI,KAAK;QACP,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAA;SACzC;QACD,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;IAChC,CAAC;IAED,IAAI,KAAK,CAAC,KAAK;QACb,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,KAAK,CAAA;QAC/B,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAA;SACvB;IACH,CAAC;CACF;AAED,MAAM,OAAO,OAAW,SAAQ,SAAY;IAI1C,YAAY,KAAQ,EAAE,IAA0B;QAC9C,KAAK,EAAE,CAAA;QACP,IAAI,CAAC,IAAI,GAAG,IAAI,CAAA;QAChB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA;QACnB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;IACpB,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,MAAM,CAAA;IACpB,CAAC;IAED,IAAI,KAAK,CAAC,KAAK;QACb,IAAI,CAAC,MAAM,GAAG,KAAK,CAAA;QACnB,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAA;SACvB;IACH,CAAC;CACF;AAED,qBAAqB;AACrB,eAAe;AACf,cAAc;AACd,IAAI;AAEJ,yCAAyC;AACzC,uDAAuD;AACvD,mBAAmB;AACnB,uBAAuB;AACvB,uBAAuB;AACvB,MAAM;AACN,IAAI;AAEJ,+CAA+C;AAC/C,2EAA2E;AAE3E,wEAAwE;AACxE,8CAA8C;AAC9C,IAAI;AAEJ,mCAAmC;AACnC,0BAA0B;AAC1B,qBAAqB;AACrB,oBAAoB;AACpB,OAAO\"}"}
